---
title: JS Setä¸ºä»€ä¹ˆæ˜¯å¸¦é”®çš„é›†åˆ?
authors: lin-xii
date: 2023-06-14
tags: [JavaScript, é›†åˆ]
---

é‡äº‹ä¸å†³æŸ¥æ–‡æ¡£ã€‚

<!-- truncate -->

## èµ·å› 

ä¸ºäº†é™ä½å¹¶å‘æ—¶çš„ API è¯·æ±‚é‡, è¿™ä¸¤å¤©å†™äº†ä¸ª LRU Cache. å…¶ä¸­ç”¨åˆ°äº† Set åš AllowList, æ¥åˆ¤æ–­ API æ˜¯å¦åº”è¯¥è¢«ç¼“å­˜.

åœ¨ MDN æŸ¥ API æ—¶, å‘ç° Set è¢«å½’ç±»åœ¨ Keyed Collection ä¸­. ä¸€ç›´ä»¥æ¥, ä¸‹æ„è¯†è§‰å¾— Set åªæ˜¯ value å”¯ä¸€çš„ Array. åº”è¯¥å±äº Indexed Collection. æ„Ÿè§‰æœ‰äº›å¥‡æ€ª, æ‰€ä»¥å°±æŸ¥äº†ä¸‹ Set çš„å®ç°æœºåˆ¶

## è¿‡ç¨‹

ä¸€å¼€å§‹, å…ˆå» MDN æŸ¥çš„æ–‡æ¡£, åªè¯´äº†å±äº Keyed Collection, ä½†æ²¡ç»†è¯´ä¸ºä»€ä¹ˆ. åˆå» ecma-international.org, æŸ¥ ECMA æ ‡å‡†, ç»“æœä¹Ÿæ²¡æœ‰æ˜ç¡®è¯´æ˜, ä¸ºä»€ä¹ˆ Set å±äº Keyed Collection. æˆ‘ä¸€å¼€å§‹è¿˜è§‰å¾—æ˜¯æ–‡æ¡£å†™å¾—ä¸å¤Ÿè¯¦ç»†, åæ¥å‘ç°æ˜¯è‡ªå·±å¤ªèœäº† ğŸ˜‚

ç®€å•æ€è€ƒäº†ä¸‹, æ²¡æƒ³é€š. å°±ä½¿ç”¨é­”æ³•æ­¦å™¨äº†. è™½ç„¶æœ‰ç‚¹å‰åä¸ä¸€, ä½† copilot æä¾›äº†æœ€å…³é”®çš„ä¿¡æ¯: Hash Table. ä¸‹è¾¹æ˜¯ copilot çš„å›ç­”

> åœ¨ JavaScript ä¸­ï¼ŒSet æ˜¯ä¸€ç§åŸºäºå“ˆå¸Œè¡¨å®ç°çš„æ•°æ®ç»“æ„ï¼Œç”¨äºå­˜å‚¨ä¸€ç»„å”¯ä¸€çš„å€¼ã€‚Set å±äº ECMAScript 6 ä¸­æ–°å¢çš„æ•°æ®ç±»å‹ä¹‹ä¸€ï¼Œè¢«å½’ç±»ä¸º Keyed Collection ç±»å‹ã€‚

> Keyed Collection æ˜¯ ECMAScript 6 ä¸­æ–°å¢çš„ä¸€ç§æ•°æ®ç±»å‹ï¼Œç”¨äºå­˜å‚¨ä¸€ç»„é”®å€¼å¯¹ã€‚é™¤äº† Set ä¹‹å¤–ï¼Œè¿˜åŒ…æ‹¬ Map å’Œ WeakMapã€‚è¿™äº›æ•°æ®ç±»å‹éƒ½å…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š

> 1. å¯ä»¥ä½¿ç”¨ä»»æ„ç±»å‹çš„å€¼ä½œä¸ºé”®ã€‚
> 2. å¯ä»¥ä½¿ç”¨ for...of å¾ªç¯éå†é”®å€¼å¯¹ã€‚
> 3. å¯ä»¥ä½¿ç”¨ size å±æ€§è·å–é”®å€¼å¯¹çš„æ•°é‡ã€‚

> Set ä½œä¸º Keyed Collection çš„ä¸€ç§ï¼Œå¯ä»¥ä½¿ç”¨ä»»æ„ç±»å‹çš„å€¼ä½œä¸ºå…ƒç´ ï¼Œè€Œä¸”æ¯ä¸ªå…ƒç´ éƒ½æ˜¯å”¯ä¸€çš„ã€‚å› æ­¤ï¼ŒSet å¯ä»¥ç”¨äºå®ç°é›†åˆã€è¿‡æ»¤é‡å¤å€¼ç­‰åŠŸèƒ½ã€‚

> éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒSet å’Œ Map çš„å®ç°æ–¹å¼ä¸åŒï¼Œè™½ç„¶å®ƒä»¬éƒ½å±äº Keyed Collection ç±»å‹ã€‚Map æ˜¯ä¸€ç§é”®å€¼å¯¹çš„é›†åˆï¼Œå…¶ä¸­æ¯ä¸ªé”®éƒ½æ˜¯å”¯ä¸€çš„ï¼Œå¯ä»¥ä½¿ç”¨é”®æ¥è®¿é—®å¯¹åº”çš„å€¼ã€‚Set æ˜¯ä¸€ç§å€¼çš„é›†åˆï¼Œå…¶ä¸­æ¯ä¸ªå€¼éƒ½æ˜¯å”¯ä¸€çš„ï¼Œå¯ä»¥ä½¿ç”¨å€¼æ¥è®¿é—®å¯¹åº”çš„å€¼ã€‚

å†ç„¶å, å°±ç ´æ¡ˆäº†... å› ä¸º Hash Table ä¸­, æ¯ä¸ªå…ƒç´ éƒ½æœ‰å”¯ä¸€çš„ key, ç”¨ key æ¥è®¿é—®å¯¹åº”çš„å€¼. æ‰€ä»¥, Set ç›¸å½“äºä¸€ä¸ª key-value ç›¸åŒçš„ã€ç‰¹æ®Šçš„ Hash Table, æˆ‘è®¤ä¸ºä¹Ÿå¯ä»¥ç†è§£ä¸º, ä¸€ç§ key-value ä¸€è‡´ã€ç‰¹æ®Šçš„ Map

## ç»“è®º

1. Set æ˜¯åŸºäº Hash Table å®ç°çš„ã€Œå€¼çš„é›†åˆã€
2. ç”±äº Hash Table çš„ key-value ç‰¹æ€§, Set çš„ key-value ç›¸åŒ
3. Set ç›¸å½“äºä¸€ç§ç‰¹æ®Šçš„ Map

æ‰€ä»¥, Set å±äº Keyed Collection

```
                                             â”Œâ”€â”€â”€â”€â”€â”
                                          â”Œâ”€â–¶â”‚Arrayâ”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â””â”€â”€â”€â”€â”€â”˜
                 â”Œâ”€â–¶â”‚Indexed Collectionâ”‚â”€â”€â”¤
                 â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚                        â””â”€â–¶â”‚Typed Arrayâ”‚
                 â”‚                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
 â”‚ Collection â”‚â”€â”€â”¤                           â”Œâ”€â”€â”€â”         *
 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚                        â”Œâ”€â–¶â”‚Mapâ”‚         *
                 â”‚                        â”‚  â””â”€â”€â”€â”˜         *
                 â”‚                        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”     *
                 â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”œâ”€â–¶â”‚WeakMapâ”‚     *  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â””â”€â–¶â”‚ Keyed Collection â”‚â”€â”€â”¤  â””â”€â”€â”€â”€â”€â”€â”€â”˜     *  â”‚Based on Hash Tableâ”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”Œâ”€â”€â”€â”         *  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                          â”œâ”€â–¶â”‚Setâ”‚         *
                                          â”‚  â””â”€â”€â”€â”˜         *
                                          â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”     *
                                          â””â”€â–¶â”‚WeakSetâ”‚     *
                                             â””â”€â”€â”€â”€â”€â”€â”€â”˜     *
```

## èµ„æ–™

1. https://262.ecma-international.org/13.0/#sec-keyed-collections
2. https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Keyed_collections#key_and_value_equality_of_map_and_set
